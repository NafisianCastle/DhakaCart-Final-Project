# Pod Security Standards for DhakaCart namespace
# This enforces security policies at the namespace level

---
# Namespace with Pod Security Standards labels
apiVersion: v1
kind: Namespace
metadata:
  name: dhakacart
  labels:
    name: dhakacart
    environment: production
    # Pod Security Standards enforcement
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
    # Pod Security Standards version
    pod-security.kubernetes.io/enforce-version: latest
    pod-security.kubernetes.io/audit-version: latest
    pod-security.kubernetes.io/warn-version: latest

---
# Security Context Constraints for DhakaCart applications
apiVersion: v1
kind: SecurityContextConstraints
metadata:
  name: dhakacart-scc
  labels:
    app: dhakacart
allowHostDirVolumePlugin: false
allowHostIPC: false
allowHostNetwork: false
allowHostPID: false
allowHostPorts: false
allowPrivilegedContainer: false
allowedCapabilities: []
defaultAddCapabilities: []
requiredDropCapabilities:
- ALL
allowedFlexVolumes: []
allowedUnsafeSysctls: []
forbiddenSysctls:
- "*"
fsGroup:
  type: MustRunAs
  ranges:
  - min: 1000
  - max: 65535
readOnlyRootFilesystem: true
runAsUser:
  type: MustRunAsNonRoot
seLinuxContext:
  type: MustRunAs
supplementalGroups:
  type: MustRunAs
  ranges:
  - min: 1000
  - max: 65535
volumes:
- configMap
- downwardAPI
- emptyDir
- persistentVolumeClaim
- projected
- secret
users:
- system:serviceaccount:dhakacart:dhakacart-backend
- system:serviceaccount:dhakacart:dhakacart-frontend
- system:serviceaccount:dhakacart:dhakacart-monitoring